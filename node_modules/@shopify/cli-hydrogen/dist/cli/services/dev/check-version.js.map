{"version":3,"file":"check-version.js","sourceRoot":"","sources":["../../../../src/cli/services/dev/check-version.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,MAAM,EAAC,MAAM,kBAAkB,CAAA;AACvC,OAAO,EAAC,kBAAkB,EAAC,MAAM,4CAA4C,CAAA;AAC7E,OAAO,EAAC,UAAU,EAAC,MAAM,0BAA0B,CAAA;AAEnD,MAAM,YAAY,GAAG,mBAAmB,CAAA;AAExC,MAAM,CAAC,KAAK,UAAU,oBAAoB,CAAC,SAAiB;IAC1D,MAAM,cAAc,GAAG,MAAM,MAAM,CAAC,aAAa,CAC/C,MAAM,EACN,CAAC,IAAI,EAAE,2BAA2B,YAAY,yBAAyB,CAAC,EACxE;QACE,GAAG,EAAE,SAAS;KACf,CACF,CAAA;IAED,IAAI,CAAC,cAAc,EAAE;QACnB,OAAM;KACP;IAED,MAAM,mBAAmB,GAAG,MAAM,kBAAkB,CAAC,YAAY,EAAE,cAAc,CAAC,CAAA;IAElF,IAAI,mBAAmB,EAAE;QACvB,UAAU,CAAC;YACT,QAAQ,EAAE,mBAAmB;YAC7B,IAAI,EACF,WAAW,mBAAmB,OAAO,YAAY,wBAAwB;gBACzE,8BAA8B,cAAc,GAAG;YACjD,SAAS,EAAE;gBACT;oBACE,IAAI,EAAE;wBACJ,KAAK,EAAE,mBAAmB;wBAC1B,GAAG,EAAE,8CAA8C;qBACpD;iBACF;aACF;SACF,CAAC,CAAA;QAEF,OAAO,mBAAmB,CAAA;KAC3B;AACH,CAAC","sourcesContent":["import {system} from '@shopify/cli-kit'\nimport {checkForNewVersion} from '@shopify/cli-kit/node/node-package-manager'\nimport {renderInfo} from '@shopify/cli-kit/node/ui'\n\nconst PACKAGE_NAME = '@shopify/hydrogen'\n\nexport async function checkHydrogenVersion(directory: string): Promise<string | undefined> {\n  const currentVersion = await system.captureOutput(\n    'node',\n    ['-p', `require('./node_modules/${PACKAGE_NAME}/package.json').version`],\n    {\n      cwd: directory,\n    },\n  )\n\n  if (!currentVersion) {\n    return\n  }\n\n  const newVersionAvailable = await checkForNewVersion(PACKAGE_NAME, currentVersion)\n\n  if (newVersionAvailable) {\n    renderInfo({\n      headline: 'Upgrade available',\n      body:\n        `Version ${newVersionAvailable} of ${PACKAGE_NAME} is now available.\\n\\n` +\n        `You are currently running v${currentVersion}.`,\n      reference: [\n        {\n          link: {\n            label: 'Hydrogen releases',\n            url: 'https://github.com/Shopify/hydrogen/releases',\n          },\n        },\n      ],\n    })\n\n    return newVersionAvailable\n  }\n}\n"]}